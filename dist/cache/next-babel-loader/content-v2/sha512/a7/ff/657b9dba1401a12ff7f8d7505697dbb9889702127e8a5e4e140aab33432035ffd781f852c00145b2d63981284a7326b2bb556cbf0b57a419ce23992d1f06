{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\didi\\\\Desktop\\\\frontend.ro\\\\client\\\\components\\\\lessons\\\\LessonExercises\\\\LessonExercises.tsx\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { connect } from 'react-redux';\nimport LessonHeading from '../LessonHeading/LessonHeading';\nimport LessonExerciseService from '~/services/LessonExercise.service';\nimport Spinner from '~/components/Spinner';\nimport ExercisePreview from '~/components/ExercisePreview';\nimport { SUBMISSION_STATUS } from '~/../shared/SharedConstants';\nimport ExerciseService from '~/services/Exercise.service';\nimport styles from './LessonExercises.module.scss';\n\nfunction LessonExercises({\n  user,\n  lessonId\n}) {\n  const isLoggedIn = !!user.info;\n  const {\n    0: submissions,\n    1: setSubmissions\n  } = useState(undefined);\n  const {\n    0: exercises,\n    1: setExercises\n  } = useState(undefined);\n  useEffect(() => {\n    LessonExerciseService.getAllExercisesForLessons(lessonId).then(exercises => setExercises(exercises)).catch(err => {\n      console.error('[LessonExercises.useEffect]', err);\n      setExercises([]);\n    });\n\n    if (isLoggedIn) {\n      ExerciseService.getSolvedExercises().then(resp => setSubmissions(resp)).catch(err => console.error(err));\n    } else {\n      setSubmissions([]);\n    }\n  }, []);\n\n  if (!Array.isArray(exercises) || !Array.isArray(submissions)) {\n    return __jsx(\"div\", {\n      id: \"exercitii\",\n      className: styles.exercises,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 7\n      }\n    }, __jsx(Spinner, {\n      showText: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  const mergedData = [];\n  exercises.forEach(ex => {\n    const matchedSubmission = submissions.find(sub => sub.exercise._id === ex._id);\n\n    if (matchedSubmission) {\n      mergedData.push(matchedSubmission);\n    } else {\n      mergedData.push({\n        code: '',\n        _id: ex._id,\n        exercise: ex,\n        feedbacks: [],\n        status: null,\n        user: user.info,\n        submittedAt: null,\n        updatedAt: null\n      });\n    }\n  });\n  console.log(\"XXX\", mergedData);\n  return __jsx(\"div\", {\n    className: `${styles.exercises} ${exercises.length === 0 ? styles['exercises--empty'] : ''}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 5\n    }\n  }, __jsx(\"section\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }, __jsx(LessonHeading, {\n    as: \"h3\",\n    id: \"exercitii\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }\n  }, \"Exerci\\u021Bii\"), exercises.length > 0 ? __jsx(\"div\", {\n    className: styles['exercises-wrapper'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 11\n    }\n  }, mergedData.map(sub => __jsx(ExercisePreview, {\n    key: sub.exercise._id,\n    exercise: sub.exercise,\n    isPrivate: false,\n    feedbackCount: sub.feedbacks.filter(f => f.type === 'improvement').length,\n    isApproved: sub.status === SUBMISSION_STATUS.DONE,\n    viewMode: \"STUDENT\",\n    readOnly: [SUBMISSION_STATUS.AWAITING_REVIEW, SUBMISSION_STATUS.DONE].includes(sub.status),\n    href: `/rezolva/${sub.exercise._id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 15\n    }\n  }))) : __jsx(\"p\", {\n    className: \"mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }, \" \\xCEn cur\\xE2nd vom ad\\u0103uga exerci\\u021Bii \"), ' ', \"la aceast\\u0103 lec\\u021Bie. P\\xE2n\\u0103 atunci po\\u021Bi s\\u0103 rezolvi celelalte\", ' ', __jsx(Link, {\n    href: \"/exercitii\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, __jsx(\"a\", {\n    className: \"text-bold\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 15\n    }\n  }, \"exerci\\u021Bii disponibile\")), \".\")));\n}\n\nfunction mapStateToProps(state) {\n  return {\n    user: state.user\n  };\n}\n\nconst connector = connect(mapStateToProps);\nexport default connector(LessonExercises);","map":{"version":3,"sources":["C:/Users/didi/Desktop/frontend.ro/client/components/lessons/LessonExercises/LessonExercises.tsx"],"names":["React","useState","useEffect","Link","connect","LessonHeading","LessonExerciseService","Spinner","ExercisePreview","SUBMISSION_STATUS","ExerciseService","styles","LessonExercises","user","lessonId","isLoggedIn","info","submissions","setSubmissions","undefined","exercises","setExercises","getAllExercisesForLessons","then","catch","err","console","error","getSolvedExercises","resp","Array","isArray","mergedData","forEach","ex","matchedSubmission","find","sub","exercise","_id","push","code","feedbacks","status","submittedAt","updatedAt","log","length","map","filter","f","type","DONE","AWAITING_REVIEW","includes","mapStateToProps","state","connector"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,SAAyBC,OAAzB,QAAwC,aAAxC;AACA,OAAOC,aAAP,MAA0B,gCAA1B;AACA,OAAOC,qBAAP,MAAkC,mCAAlC;AAEA,OAAOC,OAAP,MAAoB,sBAApB;AACA,OAAOC,eAAP,MAA4B,8BAA5B;AAGA,SAASC,iBAAT,QAAkC,6BAAlC;AACA,OAAOC,eAAP,MAA4B,6BAA5B;AAEA,OAAOC,MAAP,MAAmB,+BAAnB;;AAMA,SAASC,eAAT,CAAyB;AAAEC,EAAAA,IAAF;AAAQC,EAAAA;AAAR,CAAzB,EAAuF;AACrF,QAAMC,UAAU,GAAG,CAAC,CAACF,IAAI,CAACG,IAA1B;AAEA,QAAM;AAAA,OAACC,WAAD;AAAA,OAAcC;AAAd,MAAgCjB,QAAQ,CAAekB,SAAf,CAA9C;AACA,QAAM;AAAA,OAACC,SAAD;AAAA,OAAYC;AAAZ,MAA4BpB,QAAQ,CAAmBkB,SAAnB,CAA1C;AAEAjB,EAAAA,SAAS,CAAC,MAAM;AACdI,IAAAA,qBAAqB,CAClBgB,yBADH,CAC6BR,QAD7B,EAEGS,IAFH,CAESH,SAAD,IAAeC,YAAY,CAACD,SAAD,CAFnC,EAGGI,KAHH,CAGUC,GAAD,IAAS;AACdC,MAAAA,OAAO,CAACC,KAAR,CAAc,6BAAd,EAA6CF,GAA7C;AACAJ,MAAAA,YAAY,CAAC,EAAD,CAAZ;AACD,KANH;;AAQA,QAAIN,UAAJ,EAAgB;AACdL,MAAAA,eAAe,CACZkB,kBADH,GAEGL,IAFH,CAESM,IAAD,IAAUX,cAAc,CAACW,IAAD,CAFhC,EAGGL,KAHH,CAGUC,GAAD,IAASC,OAAO,CAACC,KAAR,CAAcF,GAAd,CAHlB;AAID,KALD,MAKO;AACLP,MAAAA,cAAc,CAAC,EAAD,CAAd;AACD;AACF,GAjBQ,EAiBN,EAjBM,CAAT;;AAmBA,MAAI,CAACY,KAAK,CAACC,OAAN,CAAcX,SAAd,CAAD,IAA6B,CAACU,KAAK,CAACC,OAAN,CAAcd,WAAd,CAAlC,EAA8D;AAC5D,WACE;AAAK,MAAA,EAAE,EAAC,WAAR;AAAoB,MAAA,SAAS,EAAEN,MAAM,CAACS,SAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,OAAD;AAAS,MAAA,QAAQ,MAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF;AAKD;;AAED,QAAMY,UAAwB,GAAG,EAAjC;AACAZ,EAAAA,SAAS,CAACa,OAAV,CAAmBC,EAAD,IAAQ;AACxB,UAAMC,iBAAiB,GAAGlB,WAAW,CAACmB,IAAZ,CAAkBC,GAAD,IAASA,GAAG,CAACC,QAAJ,CAAaC,GAAb,KAAqBL,EAAE,CAACK,GAAlD,CAA1B;;AAEA,QAAIJ,iBAAJ,EAAuB;AACrBH,MAAAA,UAAU,CAACQ,IAAX,CAAgBL,iBAAhB;AACD,KAFD,MAEO;AACLH,MAAAA,UAAU,CAACQ,IAAX,CAAgB;AACdC,QAAAA,IAAI,EAAE,EADQ;AAEdF,QAAAA,GAAG,EAAEL,EAAE,CAACK,GAFM;AAGdD,QAAAA,QAAQ,EAAEJ,EAHI;AAIdQ,QAAAA,SAAS,EAAE,EAJG;AAKdC,QAAAA,MAAM,EAAE,IALM;AAMd9B,QAAAA,IAAI,EAAEA,IAAI,CAACG,IANG;AAOd4B,QAAAA,WAAW,EAAE,IAPC;AAQdC,QAAAA,SAAS,EAAE;AARG,OAAhB;AAUD;AACF,GAjBD;AAmBAnB,EAAAA,OAAO,CAACoB,GAAR,CAAY,KAAZ,EAAmBd,UAAnB;AAEA,SACE;AAAK,IAAA,SAAS,EAAG,GAAErB,MAAM,CAACS,SAAU,IAAGA,SAAS,CAAC2B,MAAV,KAAqB,CAArB,GAAyBpC,MAAM,CAAC,kBAAD,CAA/B,GAAsD,EAAG,EAAhG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,aAAD;AAAe,IAAA,EAAE,EAAC,IAAlB;AAAuB,IAAA,EAAE,EAAC,WAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAKGS,SAAS,CAAC2B,MAAV,GAAmB,CAAnB,GACC;AAAK,IAAA,SAAS,EAAEpC,MAAM,CAAC,mBAAD,CAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGqB,UAAU,CAACgB,GAAX,CAAgBX,GAAD,IACd,MAAC,eAAD;AACE,IAAA,GAAG,EAAEA,GAAG,CAACC,QAAJ,CAAaC,GADpB;AAEE,IAAA,QAAQ,EAAEF,GAAG,CAACC,QAFhB;AAGE,IAAA,SAAS,EAAE,KAHb;AAIE,IAAA,aAAa,EAAED,GAAG,CAACK,SAAJ,CAAcO,MAAd,CAAsBC,CAAD,IAAOA,CAAC,CAACC,IAAF,KAAW,aAAvC,EAAsDJ,MAJvE;AAKE,IAAA,UAAU,EAAEV,GAAG,CAACM,MAAJ,KAAelC,iBAAiB,CAAC2C,IAL/C;AAME,IAAA,QAAQ,EAAC,SANX;AAOE,IAAA,QAAQ,EAAE,CACR3C,iBAAiB,CAAC4C,eADV,EAER5C,iBAAiB,CAAC2C,IAFV,EAGRE,QAHQ,CAGCjB,GAAG,CAACM,MAHL,CAPZ;AAWE,IAAA,IAAI,EAAG,YAAWN,GAAG,CAACC,QAAJ,CAAaC,GAAI,EAXrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,CADH,CADD,GAmBC;AAAG,IAAA,SAAS,EAAC,MAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wDADF,EAEG,GAFH,0FAKG,GALH,EAME,MAAC,IAAD;AAAM,IAAA,IAAI,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAG,IAAA,SAAS,EAAC,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCADF,CANF,MAxBJ,CADF,CADF;AA2CD;;AAED,SAASgB,eAAT,CAAyBC,KAAzB,EAA2C;AACzC,SAAO;AACL3C,IAAAA,IAAI,EAAE2C,KAAK,CAAC3C;AADP,GAAP;AAGD;;AAED,MAAM4C,SAAS,GAAGrD,OAAO,CAACmD,eAAD,CAAzB;AAEA,eAAeE,SAAS,CAAC7C,eAAD,CAAxB","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { ConnectedProps, connect } from 'react-redux';\r\nimport LessonHeading from '../LessonHeading/LessonHeading';\r\nimport LessonExerciseService from '~/services/LessonExercise.service';\r\nimport { LessonExercise } from '~/redux/user/types';\r\nimport Spinner from '~/components/Spinner';\r\nimport ExercisePreview from '~/components/ExercisePreview';\r\nimport { RootState } from '~/redux/root.reducer';\r\nimport { Submission } from '~/redux/exercise-submissions/types';\r\nimport { SUBMISSION_STATUS } from '~/../shared/SharedConstants';\r\nimport ExerciseService from '~/services/Exercise.service';\r\n\r\nimport styles from './LessonExercises.module.scss';\r\n\r\ninterface Props {\r\n  lessonId: string\r\n}\r\n\r\nfunction LessonExercises({ user, lessonId }: Props & ConnectedProps<typeof connector>) {\r\n  const isLoggedIn = !!user.info;\r\n\r\n  const [submissions, setSubmissions] = useState<Submission[]>(undefined);\r\n  const [exercises, setExercises] = useState<LessonExercise[]>(undefined);\r\n\r\n  useEffect(() => {\r\n    LessonExerciseService\r\n      .getAllExercisesForLessons(lessonId)\r\n      .then((exercises) => setExercises(exercises))\r\n      .catch((err) => {\r\n        console.error('[LessonExercises.useEffect]', err);\r\n        setExercises([]);\r\n      });\r\n\r\n    if (isLoggedIn) {\r\n      ExerciseService\r\n        .getSolvedExercises()\r\n        .then((resp) => setSubmissions(resp))\r\n        .catch((err) => console.error(err));\r\n    } else {\r\n      setSubmissions([]);\r\n    }\r\n  }, []);\r\n\r\n  if (!Array.isArray(exercises) || !Array.isArray(submissions)) {\r\n    return (\r\n      <div id=\"exercitii\" className={styles.exercises}>\r\n        <Spinner showText />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const mergedData: Submission[] = [];\r\n  exercises.forEach((ex) => {\r\n    const matchedSubmission = submissions.find((sub) => sub.exercise._id === ex._id);\r\n\r\n    if (matchedSubmission) {\r\n      mergedData.push(matchedSubmission);\r\n    } else {\r\n      mergedData.push({\r\n        code: '',\r\n        _id: ex._id,\r\n        exercise: ex,\r\n        feedbacks: [],\r\n        status: null,\r\n        user: user.info,\r\n        submittedAt: null,\r\n        updatedAt: null,\r\n      });\r\n    }\r\n  });\r\n\r\n  console.log(\"XXX\", mergedData);\r\n\r\n  return (\r\n    <div className={`${styles.exercises} ${exercises.length === 0 ? styles['exercises--empty'] : ''}`}>\r\n      <section>\r\n        <LessonHeading as=\"h3\" id=\"exercitii\">\r\n          Exerciții\r\n        </LessonHeading>\r\n\r\n        {exercises.length > 0 ? (\r\n          <div className={styles['exercises-wrapper']}>\r\n            {mergedData.map((sub) => (\r\n              <ExercisePreview\r\n                key={sub.exercise._id}\r\n                exercise={sub.exercise}\r\n                isPrivate={false}\r\n                feedbackCount={sub.feedbacks.filter((f) => f.type === 'improvement').length}\r\n                isApproved={sub.status === SUBMISSION_STATUS.DONE}\r\n                viewMode=\"STUDENT\"\r\n                readOnly={[\r\n                  SUBMISSION_STATUS.AWAITING_REVIEW,\r\n                  SUBMISSION_STATUS.DONE,\r\n                ].includes(sub.status)}\r\n                href={`/rezolva/${sub.exercise._id}`}\r\n              />\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <p className=\"mb-0\">\r\n            <strong> În curând vom adăuga exerciții </strong>\r\n            {' '}\r\n            la această lecție.\r\n            Până atunci poți să rezolvi celelalte\r\n            {' '}\r\n            <Link href=\"/exercitii\">\r\n              <a className=\"text-bold\">\r\n                exerciții disponibile\r\n              </a>\r\n            </Link>\r\n            .\r\n          </p>\r\n        )}\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction mapStateToProps(state: RootState) {\r\n  return {\r\n    user: state.user,\r\n  };\r\n}\r\n\r\nconst connector = connect(mapStateToProps);\r\n\r\nexport default connector(LessonExercises);\r\n"]},"metadata":{},"sourceType":"module"}