exports.ids = [1];
exports.modules = {

/***/ "./server/ServerUtils.ts":
/*!*******************************!*\
  !*** ./server/ServerUtils.ts ***!
  \*******************************/
/*! exports provided: PAGE_SIZE, AUTH_EXPIRATION, ServerError, setTokenCookie */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PAGE_SIZE\", function() { return PAGE_SIZE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AUTH_EXPIRATION\", function() { return AUTH_EXPIRATION; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ServerError\", function() { return ServerError; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setTokenCookie\", function() { return setTokenCookie; });\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! cookie */ \"cookie\");\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(cookie__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./database */ \"./server/database.ts\");\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\nconst PAGE_SIZE = 25;\nconst AUTH_EXPIRATION = 7;\nclass ServerError extends Error {\n  constructor(code, err, ...rest) {\n    super(...rest);\n\n    _defineProperty(this, \"code\", void 0);\n\n    _defineProperty(this, \"message\", void 0);\n\n    this.code = code;\n\n    if (typeof err === 'object') {\n      this.message = Object(_database__WEBPACK_IMPORTED_MODULE_1__[\"extractDbErrorMessage\"])(err);\n    } else {\n      this.message = err;\n    }\n  }\n\n  send(res) {\n    res.status(this.code);\n    res.json({\n      code: this.code,\n      message: this.message\n    });\n  }\n\n}\nfunction setTokenCookie(token, res) {\n  res.setHeader('Set-Cookie', cookie__WEBPACK_IMPORTED_MODULE_0___default.a.serialize('token', token, {\n    httpOnly: true,\n    secure: false,\n    sameSite: 'strict',\n    maxAge: 3600 * 24 * AUTH_EXPIRATION,\n    path: '/'\n  }));\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zZXJ2ZXIvU2VydmVyVXRpbHMudHM/Yzc3MSJdLCJuYW1lcyI6WyJQQUdFX1NJWkUiLCJBVVRIX0VYUElSQVRJT04iLCJTZXJ2ZXJFcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJjb2RlIiwiZXJyIiwicmVzdCIsIm1lc3NhZ2UiLCJleHRyYWN0RGJFcnJvck1lc3NhZ2UiLCJzZW5kIiwicmVzIiwic3RhdHVzIiwianNvbiIsInNldFRva2VuQ29va2llIiwidG9rZW4iLCJzZXRIZWFkZXIiLCJjb29raWUiLCJzZXJpYWxpemUiLCJodHRwT25seSIsInNlY3VyZSIsInNhbWVTaXRlIiwibWF4QWdlIiwicGF0aCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFFTyxNQUFNQSxTQUFTLEdBQUcsRUFBbEI7QUFDQSxNQUFNQyxlQUFlLEdBQUcsQ0FBeEI7QUFDQSxNQUFNQyxXQUFOLFNBQTBCQyxLQUExQixDQUFnQztBQUtyQ0MsYUFBVyxDQUFDQyxJQUFELEVBQU9DLEdBQVAsRUFBWSxHQUFHQyxJQUFmLEVBQXFCO0FBQzlCLFVBQU0sR0FBR0EsSUFBVDs7QUFEOEI7O0FBQUE7O0FBRzlCLFNBQUtGLElBQUwsR0FBWUEsSUFBWjs7QUFFQSxRQUFJLE9BQU9DLEdBQVAsS0FBZSxRQUFuQixFQUE2QjtBQUMzQixXQUFLRSxPQUFMLEdBQWVDLHVFQUFxQixDQUFDSCxHQUFELENBQXBDO0FBQ0QsS0FGRCxNQUVPO0FBQ0wsV0FBS0UsT0FBTCxHQUFlRixHQUFmO0FBQ0Q7QUFDRjs7QUFFREksTUFBSSxDQUFDQyxHQUFELEVBQXVCO0FBQ3pCQSxPQUFHLENBQUNDLE1BQUosQ0FBVyxLQUFLUCxJQUFoQjtBQUNBTSxPQUFHLENBQUNFLElBQUosQ0FBUztBQUNQUixVQUFJLEVBQUUsS0FBS0EsSUFESjtBQUVQRyxhQUFPLEVBQUUsS0FBS0E7QUFGUCxLQUFUO0FBSUQ7O0FBdkJvQztBQTBCaEMsU0FBU00sY0FBVCxDQUF3QkMsS0FBeEIsRUFBdUNKLEdBQXZDLEVBQWtFO0FBQ3ZFQSxLQUFHLENBQUNLLFNBQUosQ0FDRSxZQURGLEVBRUVDLDZDQUFNLENBQUNDLFNBQVAsQ0FBaUIsT0FBakIsRUFBMEJILEtBQTFCLEVBQWlDO0FBQy9CSSxZQUFRLEVBQUUsSUFEcUI7QUFFL0JDLFVBQU0sT0FGeUI7QUFHL0JDLFlBQVEsRUFBRSxRQUhxQjtBQUkvQkMsVUFBTSxFQUFFLE9BQU8sRUFBUCxHQUFZckIsZUFKVztBQUsvQnNCLFFBQUksRUFBRTtBQUx5QixHQUFqQyxDQUZGO0FBVUQiLCJmaWxlIjoiLi9zZXJ2ZXIvU2VydmVyVXRpbHMudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCBjb29raWUgZnJvbSAnY29va2llJztcbmltcG9ydCB7IGV4dHJhY3REYkVycm9yTWVzc2FnZSB9IGZyb20gJy4vZGF0YWJhc2UnO1xuXG5leHBvcnQgY29uc3QgUEFHRV9TSVpFID0gMjU7XG5leHBvcnQgY29uc3QgQVVUSF9FWFBJUkFUSU9OID0gNztcbmV4cG9ydCBjbGFzcyBTZXJ2ZXJFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29kZTogbnVtYmVyO1xuXG4gIG1lc3NhZ2U6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcihjb2RlLCBlcnIsIC4uLnJlc3QpIHtcbiAgICBzdXBlciguLi5yZXN0KTtcblxuICAgIHRoaXMuY29kZSA9IGNvZGU7XG5cbiAgICBpZiAodHlwZW9mIGVyciA9PT0gJ29iamVjdCcpIHtcbiAgICAgIHRoaXMubWVzc2FnZSA9IGV4dHJhY3REYkVycm9yTWVzc2FnZShlcnIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1lc3NhZ2UgPSBlcnI7XG4gICAgfVxuICB9XG5cbiAgc2VuZChyZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICAgIHJlcy5zdGF0dXModGhpcy5jb2RlKTtcbiAgICByZXMuanNvbih7XG4gICAgICBjb2RlOiB0aGlzLmNvZGUsXG4gICAgICBtZXNzYWdlOiB0aGlzLm1lc3NhZ2UsXG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldFRva2VuQ29va2llKHRva2VuOiBzdHJpbmcsIHJlczogTmV4dEFwaVJlc3BvbnNlPGFueT4pIHtcbiAgcmVzLnNldEhlYWRlcihcbiAgICAnU2V0LUNvb2tpZScsXG4gICAgY29va2llLnNlcmlhbGl6ZSgndG9rZW4nLCB0b2tlbiwge1xuICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAnZGV2ZWxvcG1lbnQnLFxuICAgICAgc2FtZVNpdGU6ICdzdHJpY3QnLFxuICAgICAgbWF4QWdlOiAzNjAwICogMjQgKiBBVVRIX0VYUElSQVRJT04sXG4gICAgICBwYXRoOiAnLycsXG4gICAgfSksXG4gICk7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./server/ServerUtils.ts\n");

/***/ }),

/***/ "./server/database.ts":
/*!****************************!*\
  !*** ./server/database.ts ***!
  \****************************/
/*! exports provided: connectToDb, extractDbErrorMessage, validateAgainstSchemaProps, validateObjectid */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"connectToDb\", function() { return connectToDb; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"extractDbErrorMessage\", function() { return extractDbErrorMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"validateAgainstSchemaProps\", function() { return validateAgainstSchemaProps; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"validateObjectid\", function() { return validateObjectid; });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _ServerUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ServerUtils */ \"./server/ServerUtils.ts\");\n\n\nfunction connectToDb() {\n  var _mongoose$connection;\n\n  if (((_mongoose$connection = mongoose__WEBPACK_IMPORTED_MODULE_0___default.a.connection) === null || _mongoose$connection === void 0 ? void 0 : _mongoose$connection.readyState) === 1) {\n    /** Early return - already connected */\n    return Promise.resolve(mongoose__WEBPACK_IMPORTED_MODULE_0___default.a);\n  }\n\n  return mongoose__WEBPACK_IMPORTED_MODULE_0___default.a.connect(process.env.DB_CONNECT, {\n    poolSize: 1,\n    useNewUrlParser: true,\n    useUnifiedTopology: true,\n    useFindAndModify: false,\n    useCreateIndex: true\n  });\n}\n/** Extract the first human-readable error message from a Mongoose ValidationError */\n\nfunction extractDbErrorMessage(err) {\n  if (err.errors) {\n    const keys = Object.keys(err.errors);\n    const firstKeyWithErrorMessage = keys.find(key => err.errors[key].message);\n\n    if (firstKeyWithErrorMessage) {\n      return err.errors[firstKeyWithErrorMessage].message;\n    }\n  }\n\n  return err._message || 'Oops, something went wrong...';\n}\n/** Verify that payload doesn't have extra props not present on the Schema */\n\nfunction validateAgainstSchemaProps(payload, Schema) {\n  const keys = Object.keys(payload); // eslint-disable-next-line no-restricted-syntax\n\n  for (const key of keys) {\n    if (!(key in Schema.obj)) {\n      throw new _ServerUtils__WEBPACK_IMPORTED_MODULE_1__[\"ServerError\"](400, `Property '${key}' cannot be directly set.`);\n    }\n  }\n}\nfunction validateObjectid(_id) {\n  if (!Object(mongoose__WEBPACK_IMPORTED_MODULE_0__[\"isValidObjectId\"])(_id)) {\n    throw new _ServerUtils__WEBPACK_IMPORTED_MODULE_1__[\"ServerError\"](400, `Value '${_id}' is not a valid ObjectId identifier`);\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zZXJ2ZXIvZGF0YWJhc2UudHM/NGM1ZiJdLCJuYW1lcyI6WyJjb25uZWN0VG9EYiIsIm1vbmdvb3NlIiwiY29ubmVjdGlvbiIsInJlYWR5U3RhdGUiLCJQcm9taXNlIiwicmVzb2x2ZSIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiREJfQ09OTkVDVCIsInBvb2xTaXplIiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwidXNlRmluZEFuZE1vZGlmeSIsInVzZUNyZWF0ZUluZGV4IiwiZXh0cmFjdERiRXJyb3JNZXNzYWdlIiwiZXJyIiwiZXJyb3JzIiwia2V5cyIsIk9iamVjdCIsImZpcnN0S2V5V2l0aEVycm9yTWVzc2FnZSIsImZpbmQiLCJrZXkiLCJtZXNzYWdlIiwiX21lc3NhZ2UiLCJ2YWxpZGF0ZUFnYWluc3RTY2hlbWFQcm9wcyIsInBheWxvYWQiLCJTY2hlbWEiLCJvYmoiLCJTZXJ2ZXJFcnJvciIsInZhbGlkYXRlT2JqZWN0aWQiLCJfaWQiLCJpc1ZhbGlkT2JqZWN0SWQiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRU8sU0FBU0EsV0FBVCxHQUF1QjtBQUFBOztBQUM1QixNQUFJLHlCQUFBQywrQ0FBUSxDQUFDQyxVQUFULDhFQUFxQkMsVUFBckIsTUFBb0MsQ0FBeEMsRUFBMkM7QUFDekM7QUFDQSxXQUFPQyxPQUFPLENBQUNDLE9BQVIsQ0FBZ0JKLCtDQUFoQixDQUFQO0FBQ0Q7O0FBRUQsU0FBT0EsK0NBQVEsQ0FBQ0ssT0FBVCxDQUFpQkMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBQTdCLEVBQXlDO0FBQzlDQyxZQUFRLEVBQUUsQ0FEb0M7QUFFOUNDLG1CQUFlLEVBQUUsSUFGNkI7QUFHOUNDLHNCQUFrQixFQUFFLElBSDBCO0FBSTlDQyxvQkFBZ0IsRUFBRSxLQUo0QjtBQUs5Q0Msa0JBQWMsRUFBRTtBQUw4QixHQUF6QyxDQUFQO0FBT0Q7QUFFRDs7QUFDTyxTQUFTQyxxQkFBVCxDQUErQkMsR0FBL0IsRUFBZ0Y7QUFDckYsTUFBSUEsR0FBRyxDQUFDQyxNQUFSLEVBQWdCO0FBQ2QsVUFBTUMsSUFBSSxHQUFHQyxNQUFNLENBQUNELElBQVAsQ0FBWUYsR0FBRyxDQUFDQyxNQUFoQixDQUFiO0FBQ0EsVUFBTUcsd0JBQXdCLEdBQUdGLElBQUksQ0FBQ0csSUFBTCxDQUFXQyxHQUFELElBQVNOLEdBQUcsQ0FBQ0MsTUFBSixDQUFXSyxHQUFYLEVBQWdCQyxPQUFuQyxDQUFqQzs7QUFFQSxRQUFJSCx3QkFBSixFQUE4QjtBQUM1QixhQUFPSixHQUFHLENBQUNDLE1BQUosQ0FBV0csd0JBQVgsRUFBcUNHLE9BQTVDO0FBQ0Q7QUFDRjs7QUFFRCxTQUFPUCxHQUFHLENBQUNRLFFBQUosSUFBZ0IsK0JBQXZCO0FBQ0Q7QUFFRDs7QUFDTyxTQUFTQywwQkFBVCxDQUFvQ0MsT0FBcEMsRUFBNkNDLE1BQTdDLEVBQXNFO0FBQzNFLFFBQU1ULElBQUksR0FBR0MsTUFBTSxDQUFDRCxJQUFQLENBQVlRLE9BQVosQ0FBYixDQUQyRSxDQUczRTs7QUFDQSxPQUFLLE1BQU1KLEdBQVgsSUFBa0JKLElBQWxCLEVBQXdCO0FBQ3RCLFFBQUksRUFBRUksR0FBRyxJQUFJSyxNQUFNLENBQUNDLEdBQWhCLENBQUosRUFBMEI7QUFDeEIsWUFBTSxJQUFJQyx3REFBSixDQUFnQixHQUFoQixFQUFzQixhQUFZUCxHQUFJLDJCQUF0QyxDQUFOO0FBQ0Q7QUFDRjtBQUNGO0FBRU0sU0FBU1EsZ0JBQVQsQ0FBMEJDLEdBQTFCLEVBQXVDO0FBQzVDLE1BQUksQ0FBQ0MsZ0VBQWUsQ0FBQ0QsR0FBRCxDQUFwQixFQUEyQjtBQUN6QixVQUFNLElBQUlGLHdEQUFKLENBQWdCLEdBQWhCLEVBQXNCLFVBQVNFLEdBQUksc0NBQW5DLENBQU47QUFDRDtBQUNGIiwiZmlsZSI6Ii4vc2VydmVyL2RhdGFiYXNlLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlLCB7IGlzVmFsaWRPYmplY3RJZCB9IGZyb20gJ21vbmdvb3NlJztcbmltcG9ydCB7IFNlcnZlckVycm9yIH0gZnJvbSAnLi9TZXJ2ZXJVdGlscyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBjb25uZWN0VG9EYigpIHtcbiAgaWYgKG1vbmdvb3NlLmNvbm5lY3Rpb24/LnJlYWR5U3RhdGUgPT09IDEpIHtcbiAgICAvKiogRWFybHkgcmV0dXJuIC0gYWxyZWFkeSBjb25uZWN0ZWQgKi9cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG1vbmdvb3NlKTtcbiAgfVxuXG4gIHJldHVybiBtb25nb29zZS5jb25uZWN0KHByb2Nlc3MuZW52LkRCX0NPTk5FQ1QsIHtcbiAgICBwb29sU2l6ZTogMSxcbiAgICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gICAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlLFxuICAgIHVzZUZpbmRBbmRNb2RpZnk6IGZhbHNlLFxuICAgIHVzZUNyZWF0ZUluZGV4OiB0cnVlLFxuICB9KTtcbn1cblxuLyoqIEV4dHJhY3QgdGhlIGZpcnN0IGh1bWFuLXJlYWRhYmxlIGVycm9yIG1lc3NhZ2UgZnJvbSBhIE1vbmdvb3NlIFZhbGlkYXRpb25FcnJvciAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3REYkVycm9yTWVzc2FnZShlcnI6IHsgZXJyb3JzPzogYW55LCBfbWVzc2FnZT86IHN0cmluZ30pIDpzdHJpbmcge1xuICBpZiAoZXJyLmVycm9ycykge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhlcnIuZXJyb3JzKTtcbiAgICBjb25zdCBmaXJzdEtleVdpdGhFcnJvck1lc3NhZ2UgPSBrZXlzLmZpbmQoKGtleSkgPT4gZXJyLmVycm9yc1trZXldLm1lc3NhZ2UpO1xuXG4gICAgaWYgKGZpcnN0S2V5V2l0aEVycm9yTWVzc2FnZSkge1xuICAgICAgcmV0dXJuIGVyci5lcnJvcnNbZmlyc3RLZXlXaXRoRXJyb3JNZXNzYWdlXS5tZXNzYWdlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBlcnIuX21lc3NhZ2UgfHwgJ09vcHMsIHNvbWV0aGluZyB3ZW50IHdyb25nLi4uJztcbn1cblxuLyoqIFZlcmlmeSB0aGF0IHBheWxvYWQgZG9lc24ndCBoYXZlIGV4dHJhIHByb3BzIG5vdCBwcmVzZW50IG9uIHRoZSBTY2hlbWEgKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUFnYWluc3RTY2hlbWFQcm9wcyhwYXlsb2FkLCBTY2hlbWE6IG1vbmdvb3NlLlNjaGVtYSkge1xuICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocGF5bG9hZCk7XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtc3ludGF4XG4gIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICBpZiAoIShrZXkgaW4gU2NoZW1hLm9iaikpIHtcbiAgICAgIHRocm93IG5ldyBTZXJ2ZXJFcnJvcig0MDAsIGBQcm9wZXJ0eSAnJHtrZXl9JyBjYW5ub3QgYmUgZGlyZWN0bHkgc2V0LmApO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVPYmplY3RpZChfaWQ6IHN0cmluZykge1xuICBpZiAoIWlzVmFsaWRPYmplY3RJZChfaWQpKSB7XG4gICAgdGhyb3cgbmV3IFNlcnZlckVycm9yKDQwMCwgYFZhbHVlICcke19pZH0nIGlzIG5vdCBhIHZhbGlkIE9iamVjdElkIGlkZW50aWZpZXJgKTtcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./server/database.ts\n");

/***/ })

};;