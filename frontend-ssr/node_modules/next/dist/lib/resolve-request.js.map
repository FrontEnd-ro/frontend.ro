{"version":3,"sources":["../../lib/resolve-request.ts"],"names":["resolveRequest","req","issuer","process","versions","pnp","pnpResolveRequest","require","considerBuiltins","basedir","endsWith","path","posix","sep","win32","dirname","resolve","sync"],"mappings":"2EAAA,kFACA,kD,mFAEO,QAASA,CAAAA,cAAT,CAAwBC,GAAxB,CAAqCC,MAArC,CAA6D,CAClE;AACA;AACA;AACA,GAAIC,OAAO,CAACC,QAAR,CAAiBC,GAArB,CAA0B,CACxB,KAAM,CAAEL,cAAc,CAAEM,iBAAlB,EAAwCC,OAAO,CAAE,QAAF,CAArD,CACA,MAAOD,CAAAA,iBAAiB,CAACL,GAAD,CAAMC,MAAN,CAAc,CAAEM,gBAAgB,CAAE,KAApB,CAAd,CAAxB,CACD,CAHD,IAGO,CACL,KAAMC,CAAAA,OAAO,CACXP,MAAM,CAACQ,QAAP,CAAgBC,cAAKC,KAAL,CAAWC,GAA3B,GAAmCX,MAAM,CAACQ,QAAP,CAAgBC,cAAKG,KAAL,CAAWD,GAA3B,CAAnC,CACIX,MADJ,CAEIS,cAAKI,OAAL,CAAab,MAAb,CAHN,CAIA,MAAOc,gBAAQC,IAAR,CAAahB,GAAb,CAAkB,CAAEQ,OAAF,CAAlB,CAAP,CACD,CACF","sourcesContent":["import resolve from 'next/dist/compiled/resolve/index.js'\nimport path from 'path'\n\nexport function resolveRequest(req: string, issuer: string): string {\n  // The `resolve` package is prebuilt through ncc, which prevents\n  // PnP from being able to inject itself into it. To circumvent\n  // this, we simply use PnP directly when available.\n  if (process.versions.pnp) {\n    const { resolveRequest: pnpResolveRequest } = require(`pnpapi`)\n    return pnpResolveRequest(req, issuer, { considerBuiltins: false })\n  } else {\n    const basedir =\n      issuer.endsWith(path.posix.sep) || issuer.endsWith(path.win32.sep)\n        ? issuer\n        : path.dirname(issuer)\n    return resolve.sync(req, { basedir })\n  }\n}\n"]}